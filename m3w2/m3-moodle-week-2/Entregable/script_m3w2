// SECTION 1: creating object
const products = {
    id: '000',  // variable string
    name: 'Limon',  // string type
    price: 3000,  // number type
};

// SECTION 2: using Set
const listDuplicated = [1, 2, 3, 3, 5, 7, 5, 2, 8, 6];
console.log(listDuplicated);  // displays the list
const setList = new Set(listDuplicated);  // Set declaration;
console.log('Contenido del Set  (duplicados eliminados):', [...setList]);  // displays the set from the previous list

// Adding new number to the Set
setList.add(9);
console.log('Set después de agregar el 9:', [...setList]);

// checking if a number exists in the Set
if (setList.has(3)){
    console.log('El numero 3 existe en el Set.')
};

// Delete a number from the Set
setList.delete(5);
console.log('Set despues de eliminar el 5:', [...setList]);

// Iterating the set with for...of
console.log('Recorriendo el Set con for...of:')
for (const valor of setList) {
    console.log(valor);
}

// SECTION 3: Creating the Map
const mapCategory = new Map();
function addProductMap(map, category, product){
    if (map.has(category)){
        map.get(category).push(product);  // add to the existing array
    } else {
        map.set(category, [product]) // adds the new array
    }
}

// example
let product1 = {id:'002', name:'Manzana', price: 2000, category: 'Frutas'};
let product2 = {id:'003', name:'Lechuga', price: 4000, category: 'Verduras'};
let product3 = {id:'003', name:'Uva', price: 10000, category: 'Frutas'};

addProductMap(mapCategory, product1.category, product1);
addProductMap(mapCategory, product2.category, product2);
addProductMap(mapCategory, product3.category, product3);
console.log(mapCategory)

// SECTION 4: iterations
console.log('Iterando sobr el objeto products con for...in:');
for (const property in products) {
    console.log(`${property}: ${products[property]}`);  // with for in I find the key and call it directly in each iteration
};

console.log('Interando sobre el Map con forEach:');
mapCategory.forEach((prod, cat) => {
    console.log(`Caterogia: ${cat}`);
    prod.forEach(p => {
        console.log(` -Nombre: ${p.name}, ID: ${p.id}, Precio: ${p.price}`)
    });
})

// SECTION 5: Validation and tests
function validateProduct(product){
    if (!product || typeof product !== 'object') {
        return false; // ensures that the argument is a non-empty object
    }
    if (!product.id || typeof product.id !=='string'){
        return false; // ensures that id is string and not empty
    }
    if (!product.name || typeof product.name !=='string'){
        return false; // ensures that name is string and not empty
    }
    if (typeof(product.price) !== 'number' || isNaN(product.price) || product.price <= 0){
        return false; // price must be number and positive
    }
    return true;  // if it reaches here the validation was successful
}

// validation
const listProducts = [ product1, product2, product3,
    {id: '004', name: 'Giayaba', price: -1},
    {id: 123, name: 'Maracuya', price: 3000},
];
console.log(listProducts);

// filtering valid values
const valid_products = listProducts.filter(validateProduct);
console.log(valid_products);

// Creating a set of unique names from a list obtained from the previous array
const setUniqueProducts = new Set(valid_products.map(prod => prod.name));
console.log('Lista completa de productos únicos (Set de nombres):', [...setUniqueProducts]);

// Map of categories with valid products
const mapValidCategories = new Map();
valid_products.forEach(prod => {
    addProductMap(mapValidCategories, prod.category || 'No category', prod);
});
console.log(mapValidCategories)

console.log('Categoria y nombre de productos (Map):');
mapValidCategories.forEach((prod, categori) => {
    const names = prod.map(p => prod.name). join(', ');
    console.log(`${categori}: ${names}`);
})